<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medblocks UI Kitchen Sink</title>
    <link
      rel="stylesheet"
      href="../node_modules/@shoelace-style/shoelace/dist/themes/light.css"
    />
    <style></style>
    <script type="module" src="../dist/medblocks.js"></script>
    <script src="../node_modules/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('onload');
      const form = document.getElementById('form1');
      form.addEventListener('mb-submit', e => {
        e.preventDefault();
        console.log(e.detail);
      });

      const form1 = document.getElementById('mbform');
      form1.webTemplate = {
        templateId: 'vital_signs.v1',
        semVer: '0.2.0',
        version: '2.3',
        defaultLanguage: 'en',
        languages: ['en'],
        tree: {
          id: 'vital_signs.v0',
          name: 'vital_signs.v0',
          localizedName: 'vital_signs.v0',
          rmType: 'COMPOSITION',
          nodeId: 'openEHR-EHR-COMPOSITION.encounter.v1',
          min: 1,
          max: 1,
          localizedNames: {
            en: 'vital_signs.v0',
          },
          localizedDescriptions: {
            en: 'Interaction, contact or care event between a subject of care and healthcare provider(s).',
          },
          aqlPath: '',
          children: [
            {
              id: 'context',
              rmType: 'EVENT_CONTEXT',
              nodeId: '',
              min: 1,
              max: 1,
              aqlPath: '/context',
              children: [
                {
                  id: 'start_time',
                  name: 'Start_time',
                  rmType: 'DV_DATE_TIME',
                  min: 1,
                  max: 1,
                  aqlPath: '/context/start_time',
                  inputs: [
                    {
                      type: 'DATETIME',
                    },
                  ],
                  inContext: true,
                },
                {
                  id: 'setting',
                  name: 'Setting',
                  rmType: 'DV_CODED_TEXT',
                  min: 1,
                  max: 1,
                  aqlPath: '/context/setting',
                  inputs: [
                    {
                      suffix: 'code',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'value',
                      type: 'TEXT',
                    },
                  ],
                  inContext: true,
                },
              ],
            },
            {
              id: 'pulse_heart_beat',
              name: 'Pulse/Heart beat',
              localizedName: 'Pulse/Heart beat',
              rmType: 'OBSERVATION',
              nodeId: 'openEHR-EHR-OBSERVATION.pulse.v2',
              min: 0,
              max: 1,
              localizedNames: {
                en: 'Pulse/Heart beat',
              },
              localizedDescriptions: {
                en: 'The rate and associated attributes for a pulse or heart beat.',
              },
              aqlPath: '/content[openEHR-EHR-OBSERVATION.pulse.v2]',
              children: [
                {
                  id: 'any_event',
                  name: 'Any event',
                  localizedName: 'Any event',
                  rmType: 'EVENT',
                  nodeId: 'at0003',
                  min: 0,
                  max: -1,
                  localizedNames: {
                    en: 'Any event',
                  },
                  localizedDescriptions: {
                    en: 'Default, unspecified point in time or interval event which may be explicitly defined in a template or at run-time.',
                  },
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.pulse.v2]/data[at0002]/events[at0003]',
                  children: [
                    {
                      id: 'rate',
                      name: 'Rate',
                      localizedName: 'Rate',
                      rmType: 'DV_QUANTITY',
                      nodeId: 'at0004',
                      min: 0,
                      max: 1,
                      localizedNames: {
                        en: 'Rate',
                      },
                      localizedDescriptions: {
                        en: 'The rate of the pulse or heart beat, measured in beats per minute.',
                      },
                      aqlPath:
                        '/content[openEHR-EHR-OBSERVATION.pulse.v2]/data[at0002]/events[at0003]/data[at0001]/items[at0004]/value',
                      inputs: [
                        {
                          suffix: 'magnitude',
                          type: 'DECIMAL',
                          validation: {
                            range: {
                              minOp: '>=',
                              min: 0.0,
                              maxOp: '<',
                              max: 1000.0,
                            },
                            precision: {
                              minOp: '>=',
                              min: 0,
                              maxOp: '<=',
                              max: 0,
                            },
                          },
                        },
                        {
                          suffix: 'unit',
                          type: 'CODED_TEXT',
                          list: [
                            {
                              value: '/min',
                              label: '/min',
                              validation: {
                                range: {
                                  minOp: '>=',
                                  min: 0.0,
                                  maxOp: '<',
                                  max: 1000.0,
                                },
                                precision: {
                                  minOp: '>=',
                                  min: 0,
                                  maxOp: '<=',
                                  max: 0,
                                },
                              },
                            },
                          ],
                        },
                      ],
                    },
                    {
                      id: 'time',
                      name: 'Time',
                      rmType: 'DV_DATE_TIME',
                      min: 1,
                      max: 1,
                      aqlPath:
                        '/content[openEHR-EHR-OBSERVATION.pulse.v2]/data[at0002]/events[at0003]/time',
                      inputs: [
                        {
                          type: 'DATETIME',
                        },
                      ],
                      inContext: true,
                    },
                  ],
                },
                {
                  id: 'language',
                  name: 'Language',
                  rmType: 'CODE_PHRASE',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.pulse.v2]/language',
                  inContext: true,
                },
                {
                  id: 'encoding',
                  name: 'Encoding',
                  rmType: 'CODE_PHRASE',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.pulse.v2]/encoding',
                  inContext: true,
                },
                {
                  id: 'subject',
                  name: 'Subject',
                  rmType: 'PARTY_PROXY',
                  min: 1,
                  max: 1,
                  aqlPath: '/content[openEHR-EHR-OBSERVATION.pulse.v2]/subject',
                  inputs: [
                    {
                      suffix: 'id',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'id_scheme',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'id_namespace',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'name',
                      type: 'TEXT',
                    },
                  ],
                  inContext: true,
                },
              ],
            },
            {
              id: 'blood_pressure',
              name: 'Blood pressure',
              localizedName: 'Blood pressure',
              rmType: 'OBSERVATION',
              nodeId: 'openEHR-EHR-OBSERVATION.blood_pressure.v2',
              min: 0,
              max: 1,
              localizedNames: {
                en: 'Blood pressure',
              },
              localizedDescriptions: {
                en: 'The local measurement of arterial blood pressure which is a surrogate for arterial pressure in the systemic circulation.',
              },
              annotations: {
                comment:
                  "Most commonly, use of the term 'blood pressure' refers to measurement of brachial artery pressure in the upper arm.",
              },
              aqlPath: '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]',
              children: [
                {
                  id: 'systolic',
                  name: 'Systolic',
                  localizedName: 'Systolic',
                  rmType: 'DV_QUANTITY',
                  nodeId: 'at0004',
                  min: 0,
                  max: 1,
                  localizedNames: {
                    en: 'Systolic',
                  },
                  localizedDescriptions: {
                    en: 'Peak systemic arterial blood pressure  - measured in systolic or contraction phase of the heart cycle.',
                  },
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/data[at0001]/events[at0006]/data[at0003]/items[at0004]/value',
                  inputs: [
                    {
                      suffix: 'magnitude',
                      type: 'DECIMAL',
                      validation: {
                        range: {
                          minOp: '>=',
                          min: 0.0,
                          maxOp: '<',
                          max: 1000.0,
                        },
                        precision: {
                          minOp: '>=',
                          min: 0,
                          maxOp: '<=',
                          max: 0,
                        },
                      },
                    },
                    {
                      suffix: 'unit',
                      type: 'CODED_TEXT',
                      list: [
                        {
                          value: 'mm[Hg]',
                          label: 'mm[Hg]',
                          localizedLabels: {
                            en: 'mmHg',
                          },
                          validation: {
                            range: {
                              minOp: '>=',
                              min: 0.0,
                              maxOp: '<',
                              max: 1000.0,
                            },
                            precision: {
                              minOp: '>=',
                              min: 0,
                              maxOp: '<=',
                              max: 0,
                            },
                          },
                        },
                      ],
                    },
                  ],
                  termBindings: {
                    'SNOMED-CT': {
                      value: '[SNOMED-CT(2003)::271649006]',
                      terminologyId: 'SNOMED-CT',
                    },
                  },
                },
                {
                  id: 'diastolic',
                  name: 'Diastolic',
                  localizedName: 'Diastolic',
                  rmType: 'DV_QUANTITY',
                  nodeId: 'at0005',
                  min: 0,
                  max: 1,
                  localizedNames: {
                    en: 'Diastolic',
                  },
                  localizedDescriptions: {
                    en: 'Minimum systemic arterial blood pressure - measured in the diastolic or relaxation phase of the heart cycle.',
                  },
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/data[at0001]/events[at0006]/data[at0003]/items[at0005]/value',
                  inputs: [
                    {
                      suffix: 'magnitude',
                      type: 'DECIMAL',
                      validation: {
                        range: {
                          minOp: '>=',
                          min: 0.0,
                          maxOp: '<',
                          max: 1000.0,
                        },
                        precision: {
                          minOp: '>=',
                          min: 0,
                          maxOp: '<=',
                          max: 0,
                        },
                      },
                    },
                    {
                      suffix: 'unit',
                      type: 'CODED_TEXT',
                      list: [
                        {
                          value: 'mm[Hg]',
                          label: 'mm[Hg]',
                          localizedLabels: {
                            en: 'mmHg',
                          },
                          validation: {
                            range: {
                              minOp: '>=',
                              min: 0.0,
                              maxOp: '<',
                              max: 1000.0,
                            },
                            precision: {
                              minOp: '>=',
                              min: 0,
                              maxOp: '<=',
                              max: 0,
                            },
                          },
                        },
                      ],
                    },
                  ],
                  termBindings: {
                    'SNOMED-CT': {
                      value: '[SNOMED-CT(2003)::271650006]',
                      terminologyId: 'SNOMED-CT',
                    },
                  },
                },
                {
                  id: 'time',
                  name: 'Time',
                  rmType: 'DV_DATE_TIME',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/data[at0001]/events[at0006]/time',
                  inputs: [
                    {
                      type: 'DATETIME',
                    },
                  ],
                  inContext: true,
                },
                {
                  id: 'language',
                  name: 'Language',
                  rmType: 'CODE_PHRASE',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/language',
                  inContext: true,
                },
                {
                  id: 'encoding',
                  name: 'Encoding',
                  rmType: 'CODE_PHRASE',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/encoding',
                  inContext: true,
                },
                {
                  id: 'subject',
                  name: 'Subject',
                  rmType: 'PARTY_PROXY',
                  min: 1,
                  max: 1,
                  aqlPath:
                    '/content[openEHR-EHR-OBSERVATION.blood_pressure.v2]/subject',
                  inputs: [
                    {
                      suffix: 'id',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'id_scheme',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'id_namespace',
                      type: 'TEXT',
                    },
                    {
                      suffix: 'name',
                      type: 'TEXT',
                    },
                  ],
                  inContext: true,
                },
              ],
              termBindings: {
                'SNOMED-CT': {
                  value: '[SNOMED-CT(2003)::364090009]',
                  terminologyId: 'SNOMED-CT',
                },
              },
            },
            {
              id: 'category',
              rmType: 'DV_CODED_TEXT',
              nodeId: '',
              min: 1,
              max: 1,
              aqlPath: '/category',
              inputs: [
                {
                  suffix: 'code',
                  type: 'CODED_TEXT',
                  list: [
                    {
                      value: '433',
                      label: 'event',
                      localizedLabels: {
                        en: 'event',
                      },
                    },
                  ],
                  terminology: 'openehr',
                },
              ],
              inContext: true,
            },
            {
              id: 'language',
              name: 'Language',
              rmType: 'CODE_PHRASE',
              min: 1,
              max: 1,
              aqlPath: '/language',
              inContext: true,
            },
            {
              id: 'territory',
              name: 'Territory',
              rmType: 'CODE_PHRASE',
              min: 1,
              max: 1,
              aqlPath: '/territory',
              inContext: true,
            },
            {
              id: 'composer',
              name: 'Composer',
              rmType: 'PARTY_PROXY',
              min: 1,
              max: 1,
              aqlPath: '/composer',
              inputs: [
                {
                  suffix: 'id',
                  type: 'TEXT',
                },
                {
                  suffix: 'id_scheme',
                  type: 'TEXT',
                },
                {
                  suffix: 'id_namespace',
                  type: 'TEXT',
                },
                {
                  suffix: 'name',
                  type: 'TEXT',
                },
              ],
              inContext: true,
            },
          ],
        },
      };
    });
  </script>

  <body>
    <div style="max-width: 700px">
      <mb-auto-form id="mbform"></mb-auto-form>
      <mb-form id="form1">
        <mb-context path="vital_signs.v0/context/start_time"></mb-context>
        <mb-context path="vital_signs.v0/context/setting"></mb-context>
        <mb-quantity
          default="/min"
          path="vital_signs.v0/pulse_heart_beat/any_event:0/rate"
          label="Rate"
        >
          <mb-unit unit="/min" label="/min" min="" max="1000"></mb-unit>
        </mb-quantity>
        <mb-context
          path="vital_signs.v0/pulse_heart_beat/any_event:0/time"
        ></mb-context>
        <mb-context
          path="vital_signs.v0/pulse_heart_beat/language"
        ></mb-context>
        <mb-context
          path="vital_signs.v0/pulse_heart_beat/encoding"
        ></mb-context>
        <mb-context path="vital_signs.v0/pulse_heart_beat/subject"></mb-context>
        <div class="blood-pressure-container">
          <mb-quantity
            default="mm[Hg]"
            path="vital_signs.v0/blood_pressure/systolic"
            label="Systolic"
          >
            <mb-unit unit="mm[Hg]" label="mm[Hg]" min="" max="1000"></mb-unit>
          </mb-quantity>
          <mb-quantity
            default="mm[Hg]"
            path="vital_signs.v0/blood_pressure/diastolic"
            label="Diastolic"
          >
            <mb-unit unit="mm[Hg]" label="mm[Hg]" min="" max="1000"></mb-unit>
          </mb-quantity>
        </div>
        <mb-context path="vital_signs.v0/blood_pressure/time"></mb-context>
        <mb-context path="vital_signs.v0/blood_pressure/language"></mb-context>
        <mb-context path="vital_signs.v0/blood_pressure/encoding"></mb-context>
        <mb-context path="vital_signs.v0/blood_pressure/subject"></mb-context>
        <mb-context path="vital_signs.v0/category"></mb-context>
        <mb-context path="vital_signs.v0/language"></mb-context>
        <mb-context path="vital_signs.v0/territory"></mb-context>
        <mb-context path="vital_signs.v0/composer"></mb-context>

        <div>
          <mb-submit type="primary">
            <sl-button>Save</sl-button>
          </mb-submit>
        </div>
      </mb-form>
    </div>
    <div>
      <pre></pre>
    </div>
  </body>
</html>
